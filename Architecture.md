# Architecture

## How Sqlite works

A query goes through a chain of components in order to retrieve data. The **front-end** consists of the:

- tokenizer
- parser
- code generator

The input to the front-end is a SQL query. The output is sqlite virtual machine bytecode (essentially a compiled program that can operate on the database).

The **back-end** consists of the:

- virtual machine
- B-tree
- pager
- os interface

The **virtual machine** takes bytecode generated by the front-end as instructions. It can then perform operations on one or more tables or indexes, each of which is stored in a data structure called a B-tree. The VM is essentially a big switch statement on the type of bytecode instruction.

Each **B-tree** consists of many nodes. Each node is one page in lenght. The B-tree can retrieve a page from disk or save it back to disk by issuing commands to the pager.

The **pager** receives commands to read or write pages of data. It is responsible for reading/writing at appropriate offsets in the database file. It also keeps a cache of recently-accessed pages in memory, and determines when those pages need to be written back to disk.

The **os interface** is the layer that differs depending on which operating system sqlite was compiled for.
